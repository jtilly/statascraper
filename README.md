# statascraper [![Build Status](https://travis-ci.org/jtilly/statascraper.svg?branch=master)](https://travis-ci.org/jtilly/statascraper)

R Package that extracts tables from STATA logfiles

This package scrapes STATA logfiles, looks for tables generated by `tab`, `tabstat`, `list`,  `reg`, and `areg` and then returns these tables as R matrices or stores them as comma separated value files. This package can be useful, when researchers (have to) use STATA to work with data sets but want to use R to analyze and display results.

## Installation

``` r
# install.packages("devtools")
devtools::install_github("jtilly/statascraper")
```

## Example

Suppose you have the following STATA do-file:

``` stata
log using "test.log", replace
webuse auto.dta
di "tab2r tab.RData"
tab make foreign
log close
```

This do-file produces a logfile that looks like this:

```
. di "tab2r tab.RData"
tab2r tab.RData

. tab make foreign

                   |       Car type
    Make and Model |  Domestic    Foreign |     Total
-------------------+----------------------+----------
       AMC Concord |         1          0 |         1 
         AMC Pacer |         1          0 |         1 
        AMC Spirit |         1          0 |         1 
         Audi 5000 |         0          1 |         1 
          Audi Fox |         0          1 |         1 
          BMW 320i |         0          1 |         1 
     Buick Century |         1          0 |         1 
...
```

We now use `statascraper` to retrieve the tabulated output in R. Note that we use STATA's display command `di` to place markers in the logfile that tell `statascraper` which tables to scrape and where to store the resulting RData or csv files. For instance, `tab2r tab.RData` tells the scraper to scrape the results from tab and store them in the file `tab.RData`. 

``` r
library("statascraper")
# read tab commands
read.tab(filename = "test.log", outdir = ".", RData = TRUE, tag = "tab2r")
#> [1] "Created tab.RData"
head(load.RData("tab.RData"))
#>             Domestic Foreign Total
#> AMC Concord        1       0     1
#> AMC Pacer          1       0     1
#> AMC Spirit         1       0     1
#> Audi 5000          0       1     1
#> Audi Fox           0       1     1
#> BMW 320i           0       1     1
```

A complete example can be found [here](https://github.com/jtilly/statascraper/blob/master/demo/statascraper.R) with corresponding [STATA do-file](https://github.com/jtilly/statascraper/blob/master/inst/example/stata.do) and [STATA logfile](https://github.com/jtilly/statascraper/blob/master/inst/example/test.log).
